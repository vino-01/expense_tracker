<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrackWise - Your Smart Expense Buddy</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }

        /* Loading Styles */
        .loading-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Authentication Styles */
        .auth-container {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .auth-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: -1;
        }

        .auth-background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.6s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-header h1 {
            color: white;
            font-size: 28px;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .auth-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            position: relative;
        }

        .form-input {
            width: 100%;
            padding: 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: #333;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input::placeholder {
            color: rgba(0, 0, 0, 0.6);
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .form-input:focus + .form-label,
        .form-input:not(:placeholder-shown) + .form-label {
            transform: translateY(-35px) scale(0.85);
            color: rgba(255, 255, 255, 0.9);
            background: rgba(58, 12, 163, 0.8);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .form-label {
            position: absolute;
            left: 16px;
            top: 16px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            pointer-events: none;
            transition: all 0.3s ease;
            transform-origin: left top;
        }

        .form-input.error {
            border-color: #F72585;
            box-shadow: 0 0 20px rgba(247, 37, 133, 0.3);
        }

        .error-message {
            color: #F72585;
            font-size: 12px;
            margin-top: 5px;
            font-weight: 500;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .auth-button {
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .auth-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .auth-button:hover::before {
            left: 100%;
        }

        .auth-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(58, 12, 163, 0.4);
        }

        .auth-button:active {
            transform: translateY(0);
            animation: pulse 0.3s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.98); }
            100% { transform: scale(1); }
        }

        .auth-footer {
            text-align: center;
            margin-top: 25px;
        }

        .auth-footer p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .auth-footer a {
            color: #4CC9F0;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .auth-footer a:hover {
            color: white;
            text-shadow: 0 0 10px rgba(76, 201, 240, 0.5);
        }

        /* Navbar Styles */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .navbar-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            font-size: 24px;
            font-weight: 700;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .navbar-brand:hover {
            transform: scale(1.05);
        }

        .brand-icon {
            font-size: 28px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .navbar-menu {
            display: flex;
            align-items: center;
            gap: 40px;
        }

        .navbar-nav {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: #666;
            font-weight: 500;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .nav-link:hover {
            color: #3A0CA3;
            background: rgba(58, 12, 163, 0.1);
            transform: translateY(-2px);
        }

        .nav-link.active {
            color: #3A0CA3;
            background: rgba(58, 12, 163, 0.1);
            font-weight: 600;
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 3px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            border-radius: 2px;
        }

        .navbar-user {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 15px rgba(58, 12, 163, 0.3);
        }

        .user-name {
            font-weight: 600;
            color: #333;
            font-size: 16px;
        }

        .logout-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        /* Dashboard Styles */
        .dashboard {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            padding-top: 100px;
        }

        .welcome-banner {
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(58, 12, 163, 0.2);
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .welcome-banner h1 {
            font-size: 32px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .welcome-banner p {
            font-size: 16px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            font-size: 40px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(58, 12, 163, 0.3);
        }

        .stat-content h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-amount {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin: 0;
        }

        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 100px;
        }

        .charts-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-container h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 20px;
        }

        .recent-expenses {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-header h2 {
            color: #333;
            font-size: 20px;
        }

        .view-all-btn {
            color: #3A0CA3;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .view-all-btn:hover {
            color: #F72585;
        }

        .expenses-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .expense-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateX(5px);
        }

        .expense-category {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .category-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
        }

        .expense-details h4 {
            font-size: 16px;
            color: #333;
            margin-bottom: 4px;
        }

        .expense-details p {
            font-size: 14px;
            color: #666;
            margin-bottom: 2px;
        }

        .expense-details small {
            font-size: 12px;
            color: #999;
        }

        .expense-amount {
            font-size: 18px;
            font-weight: 700;
            color: #3A0CA3;
        }

        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(58, 12, 163, 0.3);
        }

        .btn-primary:active {
            transform: translateY(0);
            animation: bounce 0.3s ease;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-4px); }
            80% { transform: translateY(-2px); }
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #333;
            border: 2px solid #ddd;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
            border-color: #3A0CA3;
            color: #3A0CA3;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(58, 12, 163, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(58, 12, 163, 0.4);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* Add Expense Form Styles */
        .add-expense {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            padding-top: 100px;
            position: relative;
        }

        .add-expense-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .add-expense-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .add-expense-header h1 {
            font-size: 32px;
            color: #333;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .add-expense-header p {
            color: #666;
            font-size: 16px;
        }

        .expense-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #3A0CA3;
            box-shadow: 0 0 0 4px rgba(58, 12, 163, 0.1);
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.95);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti::before, .confetti::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, #3A0CA3 2px, transparent 2px),
                radial-gradient(circle, #F72585 2px, transparent 2px),
                radial-gradient(circle, #4CC9F0 2px, transparent 2px),
                radial-gradient(circle, #7209B7 2px, transparent 2px);
            background-size: 50px 50px, 60px 60px, 40px 40px, 70px 70px;
            background-position: 0 0, 20px 20px, 40px 40px, 60px 60px;
            animation: confetti-fall 3s ease-out;
        }

        .confetti::after {
            animation-delay: 0.5s;
            background-image: 
                radial-gradient(circle, #560BAD 2px, transparent 2px),
                radial-gradient(circle, #F72585 2px, transparent 2px),
                radial-gradient(circle, #4CC9F0 2px, transparent 2px);
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Expenses List Styles */
        .expenses-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            padding-top: 100px;
        }

        .expenses-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .expenses-header h1 {
            font-size: 32px;
            color: #333;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .filters-section {
            max-width: 1200px;
            margin: 0 auto 30px auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-input {
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .filter-input:focus {
            outline: none;
            border-color: #3A0CA3;
            box-shadow: 0 0 0 3px rgba(58, 12, 163, 0.1);
        }

        .expenses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .expense-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .expense-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
        }

        .expense-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .expense-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .expense-note {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(58, 12, 163, 0.05);
            border-radius: 10px;
            border-left: 4px solid #3A0CA3;
        }

        .expense-note p {
            color: #555;
            font-style: italic;
            margin: 0;
            line-height: 1.5;
        }

        .expense-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-edit, .btn-delete {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-edit {
            background: linear-gradient(135deg, #4CC9F0, #3A0CA3);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.4);
        }

        .btn-delete {
            background: linear-gradient(135deg, #F72585, #dc3545);
            color: white;
        }

        .btn-delete:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(247, 37, 133, 0.4);
        }

        /* Profile Styles */
        .profile {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            padding-top: 100px;
        }

        .profile-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .profile-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 30px;
            position: relative;
            overflow: hidden;
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3A0CA3, #F72585);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: white;
            box-shadow: 0 10px 30px rgba(58, 12, 163, 0.3);
            flex-shrink: 0;
        }

        .profile-info h1 {
            font-size: 32px;
            color: #333;
            margin-bottom: 8px;
        }

        .profile-info p {
            font-size: 16px;
            color: #666;
            margin-bottom: 5px;
        }

        .profile-stats {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .profile-stats h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #3A0CA3;
            margin: 0;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
            text-align: center;
        }

        .modal h3 {
            font-size: 24px;
            color: #333;
            margin-bottom: 15px;
        }

        .modal p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .navbar-container {
                padding: 0 15px;
                height: 60px;
            }

            .dashboard, .add-expense, .expenses-page, .profile {
                padding: 15px;
                padding-top: 80px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .expenses-grid {
                grid-template-columns: 1fr;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }
        }

        .no-expenses {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 1200px;
            margin: 0 auto;
        }

        .no-expenses h3 {
            font-size: 24px;
            color: #333;
            margin-bottom: 15px;
        }

        .no-expenses p {
            color: #666;
            font-size: 16px;
            margin-bottom: 25px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useContext, createContext } = React;

        // Mock API Base URL
        const API_BASE_URL = 'http://localhost:5000/api';

        // Auth Context
        const AuthContext = createContext();

        const useAuth = () => {
            const context = useContext(AuthContext);
            if (!context) {
                throw new Error('useAuth must be used within an AuthProvider');
            }
            return context;
        };

        // Mock Data for Development
        const mockExpenses = [
            {
                _id: '1',
                amount: 750,
                category: 'Food',
                note: 'Dinner at KFC',
                date: '2024-01-15',
                userId: 'user1'
            },
            {
                _id: '2',
                amount: 2500,
                category: 'Travel',
                note: 'Bus ticket to Mumbai',
                date: '2024-01-10',
                userId: 'user1'
            },
            {
                _id: '3',
                amount: 15000,
                category: 'Rent',
                note: 'Monthly rent payment',
                date: '2024-01-01',
                userId: 'user1'
            },
            {
                _id: '4',
                amount: 1200,
                category: 'Shopping',
                note: 'New shirt and jeans',
                date: '2024-01-20',
                userId: 'user1'
            },
            {
                _id: '5',
                amount: 500,
                category: 'Others',
                note: 'Mobile recharge',
                date: '2024-01-25',
                userId: 'user1'
            }
        ];

        const mockUser = {
            id: 'user1',
            username: 'Vino',
            email: 'vino@email.com',
            createdAt: '2024-01-01'
        };

        // Auth Provider Component
        const AuthProvider = ({ children }) => {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);

            // Set up axios defaults
            const API_BASE_URL = 'http://localhost:5000/api';
            axios.defaults.baseURL = API_BASE_URL;

            useEffect(() => {
                const token = localStorage.getItem('token');
                if (token) {
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    fetchUser();
                } else {
                    setLoading(false);
                }
            }, []);

            const fetchUser = async () => {
                try {
                    const response = await axios.get('/auth/user');
                    setUser(response.data);
                } catch (error) {
                    console.error('Error fetching user:', error);
                    localStorage.removeItem('token');
                    delete axios.defaults.headers.common['Authorization'];
                } finally {
                    setLoading(false);
                }
            };

            const login = async (email, password) => {
                try {
                    const response = await axios.post('/auth/login', { email, password });
                    const { token, user } = response.data;

                    localStorage.setItem('token', token);
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    setUser(user);

                    return { success: true };
                } catch (error) {
                    return {
                        success: false,
                        message: error.response?.data?.message || 'Login failed'
                    };
                }
            };

            const register = async (username, email, password) => {
                try {
                    const response = await axios.post('/auth/register', { username, email, password });
                    const { token, user } = response.data;

                    localStorage.setItem('token', token);
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    setUser(user);

                    return { success: true };
                } catch (error) {
                    return {
                        success: false,
                        message: error.response?.data?.message || 'Registration failed'
                    };
                }
            };

            const logout = () => {
                localStorage.removeItem('token');
                delete axios.defaults.headers.common['Authorization'];
                setUser(null);
            };

            const value = {
                user,
                login,
                register,
                logout,
                loading
            };

            return (
                <AuthContext.Provider value={value}>
                    {children}
                </AuthContext.Provider>
            );
        };

        // Login Component
        const Login = ({ onSwitchToSignup }) => {
            const [formData, setFormData] = useState({
                email: '',
                password: ''
            });
            const [errors, setErrors] = useState({});
            const [loading, setLoading] = useState(false);
            const { login } = useAuth();

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));
                if (errors[name]) {
                    setErrors(prev => ({
                        ...prev,
                        [name]: ''
                    }));
                }
            };

            const validateForm = () => {
                const newErrors = {};
                if (!formData.email) {
                    newErrors.email = 'Email is required';
                } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
                    newErrors.email = 'Email is invalid';
                }
                if (!formData.password) {
                    newErrors.password = 'Password is required';
                } else if (formData.password.length < 6) {
                    newErrors.password = 'Password must be at least 6 characters';
                }
                return newErrors;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                const newErrors = validateForm();
                
                if (Object.keys(newErrors).length > 0) {
                    setErrors(newErrors);
                    return;
                }

                setLoading(true);
                const result = await login(formData.email, formData.password);
                
                if (!result.success) {
                    setErrors({ general: result.message });
                }
                setLoading(false);
            };

            return (
                <div className="auth-container">
                    <div className="auth-background"></div>
                    <div className="auth-card">
                        <div className="auth-header">
                            <h1>Welcome Back!</h1>
                            <p>Sign in to TrackWise</p>
                        </div>

                        <form onSubmit={handleSubmit} className="auth-form">
                            {errors.general && (
                                <div className="error-message" style={{textAlign: 'center', marginBottom: '20px'}}>
                                    {errors.general}
                                </div>
                            )}

                            <div className="form-group">
                                <input
                                    type="email"
                                    name="email"
                                    value={formData.email}
                                    onChange={handleChange}
                                    className={`form-input ${errors.email ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Email Address</label>
                                {errors.email && <span className="error-message">{errors.email}</span>}
                            </div>

                            <div className="form-group">
                                <input
                                    type="password"
                                    name="password"
                                    value={formData.password}
                                    onChange={handleChange}
                                    className={`form-input ${errors.password ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Password</label>
                                {errors.password && <span className="error-message">{errors.password}</span>}
                            </div>

                            <button type="submit" className="auth-button" disabled={loading}>
                                {loading ? 'Signing In...' : 'Sign In'}
                            </button>
                        </form>

                        <div className="auth-footer">
                            <p>
                                Don't have an account? <a onClick={onSwitchToSignup}>Sign up here</a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Signup Component
        const Signup = ({ onSwitchToLogin }) => {
            const [formData, setFormData] = useState({
                username: '',
                email: '',
                password: '',
                confirmPassword: ''
            });
            const [errors, setErrors] = useState({});
            const [loading, setLoading] = useState(false);
            const { register } = useAuth();

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));
                if (errors[name]) {
                    setErrors(prev => ({
                        ...prev,
                        [name]: ''
                    }));
                }
            };

            const validateForm = () => {
                const newErrors = {};
                if (!formData.username) {
                    newErrors.username = 'Username is required';
                } else if (formData.username.length < 3) {
                    newErrors.username = 'Username must be at least 3 characters';
                }
                if (!formData.email) {
                    newErrors.email = 'Email is required';
                } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
                    newErrors.email = 'Email is invalid';
                }
                if (!formData.password) {
                    newErrors.password = 'Password is required';
                } else if (formData.password.length < 6) {
                    newErrors.password = 'Password must be at least 6 characters';
                }
                if (!formData.confirmPassword) {
                    newErrors.confirmPassword = 'Please confirm your password';
                } else if (formData.password !== formData.confirmPassword) {
                    newErrors.confirmPassword = 'Passwords do not match';
                }
                return newErrors;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                const newErrors = validateForm();
                
                if (Object.keys(newErrors).length > 0) {
                    setErrors(newErrors);
                    return;
                }

                setLoading(true);
                const result = await register(formData.username, formData.email, formData.password);
                
                if (!result.success) {
                    setErrors({ general: result.message });
                }
                setLoading(false);
            };

            return (
                <div className="auth-container">
                    <div className="auth-background"></div>
                    <div className="auth-card">
                        <div className="auth-header">
                            <h1>Join TrackWise!</h1>
                            <p>Create your account</p>
                        </div>

                        <form onSubmit={handleSubmit} className="auth-form">
                            {errors.general && (
                                <div className="error-message" style={{textAlign: 'center', marginBottom: '20px'}}>
                                    {errors.general}
                                </div>
                            )}

                            <div className="form-group">
                                <input
                                    type="text"
                                    name="username"
                                    value={formData.username}
                                    onChange={handleChange}
                                    className={`form-input ${errors.username ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Username</label>
                                {errors.username && <span className="error-message">{errors.username}</span>}
                            </div>

                            <div className="form-group">
                                <input
                                    type="email"
                                    name="email"
                                    value={formData.email}
                                    onChange={handleChange}
                                    className={`form-input ${errors.email ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Email Address</label>
                                {errors.email && <span className="error-message">{errors.email}</span>}
                            </div>

                            <div className="form-group">
                                <input
                                    type="password"
                                    name="password"
                                    value={formData.password}
                                    onChange={handleChange}
                                    className={`form-input ${errors.password ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Password</label>
                                {errors.password && <span className="error-message">{errors.password}</span>}
                            </div>

                            <div className="form-group">
                                <input
                                    type="password"
                                    name="confirmPassword"
                                    value={formData.confirmPassword}
                                    onChange={handleChange}
                                    className={`form-input ${errors.confirmPassword ? 'error' : ''}`}
                                    placeholder=" "
                                    required
                                />
                                <label className="form-label">Confirm Password</label>
                                {errors.confirmPassword && <span className="error-message">{errors.confirmPassword}</span>}
                            </div>

                            <button type="submit" className="auth-button" disabled={loading}>
                                {loading ? 'Creating Account...' : 'Create Account'}
                            </button>
                        </form>

                        <div className="auth-footer">
                            <p>
                                Already have an account? <a onClick={onSwitchToLogin}>Sign in here</a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Navbar Component
        const Navbar = ({ currentPage, onNavigate }) => {
            const { user, logout } = useAuth();

            const navItems = [
                { key: 'dashboard', label: 'Dashboard', icon: '' },
                { key: 'expenses', label: 'Expenses', icon: '' },
                { key: 'add-expense', label: 'Add Expense', icon: '' },
                { key: 'profile', label: 'Profile', icon: '' }
            ];

            return (
                <nav className="navbar">
                    <div className="navbar-container">
                        <div className="navbar-brand" onClick={() => onNavigate('dashboard')}>
                            <span className="brand-icon"></span>
                            TrackWise
                        </div>

                        <div className="navbar-menu">
                            <div className="navbar-nav">
                                {navItems.map(item => (
                                    <div
                                        key={item.key}
                                        className={`nav-link ${currentPage === item.key ? 'active' : ''}`}
                                        onClick={() => onNavigate(item.key)}
                                    >
                                        <span className="nav-icon">{item.icon}</span>
                                        {item.label}
                                    </div>
                                ))}
                            </div>

                            <div className="navbar-user">
                                <div className="user-info">
                                    <div className="user-avatar">
                                        {user?.username?.charAt(0).toUpperCase()}
                                    </div>
                                    <span className="user-name">{user?.username}</span>
                                </div>
                                <button onClick={logout} className="logout-btn">
                                    Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </nav>
            );
        };

        // Dashboard Component
        const Dashboard = ({ onNavigate }) => {
            const { user } = useAuth();
            const [expenses, setExpenses] = useState([]);
            const [loading, setLoading] = useState(true);
            const [stats, setStats] = useState({
                thisMonth: 0,
                thisWeek: 0,
                thisYear: 0,
                totalExpenses: 0
            });

            useEffect(() => {
                fetchExpenses();
            }, []);

            useEffect(() => {
                if (expenses.length > 0) {
                    calculateStats(expenses);
                    createCharts();
                }
            }, [expenses]);

            const fetchExpenses = async () => {
                try {
                    const response = await axios.get('/expenses');
                    setExpenses(response.data);
                } catch (error) {
                    console.error('Error fetching expenses:', error);
                } finally {
                    setLoading(false);
                }
            };

            const calculateStats = (expensesData) => {
                const now = new Date();
                const thisMonth = now.getMonth();
                const thisYear = now.getFullYear();
                const thisWeekStart = new Date(now.setDate(now.getDate() - now.getDay()));

                const stats = expensesData.reduce((acc, expense) => {
                    const expenseDate = new Date(expense.date);
                    const amount = parseFloat(expense.amount);

                    acc.totalExpenses += amount;

                    if (expenseDate.getFullYear() === thisYear) {
                        acc.thisYear += amount;
                    }

                    if (expenseDate.getMonth() === thisMonth && expenseDate.getFullYear() === thisYear) {
                        acc.thisMonth += amount;
                    }

                    if (expenseDate >= thisWeekStart) {
                        acc.thisWeek += amount;
                    }

                    return acc;
                }, {
                    thisMonth: 0,
                    thisWeek: 0,
                    thisYear: 0,
                    totalExpenses: 0
                });

                setStats(stats);
            };

            const createCharts = () => {
                // Monthly Chart
                const monthlyCtx = document.getElementById('monthlyChart');
                if (monthlyCtx) {
                    const monthlyData = getMonthlyData();
                    new Chart(monthlyCtx, {
                        type: 'bar',
                        data: {
                            labels: monthlyData.map(d => d.month),
                            datasets: [{
                                label: 'Amount ()',
                                data: monthlyData.map(d => d.amount),
                                backgroundColor: 'rgba(58, 12, 163, 0.8)',
                                borderColor: 'rgba(58, 12, 163, 1)',
                                borderWidth: 1,
                                borderRadius: 8
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return '' + value;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // Category Chart
                const categoryCtx = document.getElementById('categoryChart');
                if (categoryCtx) {
                    const categoryData = getCategoryData();
                    new Chart(categoryCtx, {
                        type: 'pie',
                        data: {
                            labels: categoryData.map(d => d.name),
                            datasets: [{
                                data: categoryData.map(d => d.value),
                                backgroundColor: [
                                    '#3A0CA3',
                                    '#F72585',
                                    '#4CC9F0',
                                    '#7209B7',
                                    '#560BAD'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
            };

            const getMonthlyData = () => {
                const monthlyData = {};
                const currentYear = new Date().getFullYear();

                // Initialize all months with 0
                for (let i = 0; i < 12; i++) {
                    const monthName = new Date(currentYear, i).toLocaleString('default', { month: 'short' });
                    monthlyData[monthName] = 0;
                }

                // Aggregate expenses by month
                expenses.forEach(expense => {
                    const date = new Date(expense.date);
                    if (date.getFullYear() === currentYear) {
                        const monthName = date.toLocaleString('default', { month: 'short' });
                        monthlyData[monthName] += parseFloat(expense.amount);
                    }
                });

                return Object.entries(monthlyData).map(([month, amount]) => ({
                    month,
                    amount: parseFloat(amount.toFixed(2))
                }));
            };

            const getCategoryData = () => {
                const categoryData = {};

                expenses.forEach(expense => {
                    const category = expense.category;
                    categoryData[category] = (categoryData[category] || 0) + parseFloat(expense.amount);
                });

                return Object.entries(categoryData).map(([name, value]) => ({
                    name,
                    value: parseFloat(value.toFixed(2))
                }));
            };

            const getRecentExpenses = () => {
                return expenses.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            };

            const getCategoryIcon = (category) => {
                const icons = {
                    'Food': '',
                    'Travel': '',
                    'Rent': '',
                    'Shopping': '',
                    'Others': ''
                };
                return icons[category] || '';
            };

            return (
                <div className="dashboard">
                    <div className="welcome-banner">
                        <h1>Welcome back, {user?.username}! </h1>
                        <p>Here's your expense overview</p>
                    </div>

                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-icon"></div>
                            <div className="stat-content">
                                <h3>This Month</h3>
                                <p className="stat-amount">{stats.thisMonth.toFixed(2)}</p>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-icon"></div>
                            <div className="stat-content">
                                <h3>This Week</h3>
                                <p className="stat-amount">{stats.thisWeek.toFixed(2)}</p>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-icon"></div>
                            <div className="stat-content">
                                <h3>This Year</h3>
                                <p className="stat-amount">{stats.thisYear.toFixed(2)}</p>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-icon"></div>
                            <div className="stat-content">
                                <h3>Total Expenses</h3>
                                <p className="stat-amount">{stats.totalExpenses.toFixed(2)}</p>
                            </div>
                        </div>
                    </div>

                    <div className="dashboard-content">
                        <div className="charts-section">
                            <div className="chart-container">
                                <h2>Monthly Spending</h2>
                                <canvas id="monthlyChart" width="400" height="200"></canvas>
                            </div>

                            <div className="chart-container">
                                <h2>Category Breakdown</h2>
                                <canvas id="categoryChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <div className="recent-expenses">
                            <div className="section-header">
                                <h2>Recent Expenses</h2>
                                <span className="view-all-btn" onClick={() => onNavigate('expenses')}>
                                    View All
                                </span>
                            </div>

                            {getRecentExpenses().length > 0 ? (
                                <div className="expenses-list">
                                    {getRecentExpenses().map(expense => (
                                        <div key={expense._id} className="expense-item">
                                            <div className="expense-category">
                                                <span className="category-icon">
                                                    {getCategoryIcon(expense.category)}
                                                </span>
                                                <div className="expense-details">
                                                    <h4>{expense.category}</h4>
                                                    <p>{expense.note}</p>
                                                    <small>{new Date(expense.date).toLocaleDateString()}</small>
                                                </div>
                                            </div>
                                            <div className="expense-amount">{parseFloat(expense.amount).toFixed(2)}</div>
                                        </div>
                                    ))}
                                </div>
                            ) : (
                                <div className="no-expenses">
                                    <p>No expenses yet. <span className="view-all-btn" onClick={() => onNavigate('add-expense')}>Add your first expense!</span></p>
                                </div>
                            )}
                        </div>
                    </div>

                    <button className="fab" onClick={() => onNavigate('add-expense')}>
                        <span>+</span>
                    </button>
                </div>
            );
        };

        // Add Expense Component
        const AddExpense = ({ onNavigate, editingExpense = null }) => {
            const [formData, setFormData] = useState({
                amount: '',
                date: new Date().toISOString().split('T')[0],
                category: 'Food',
                note: ''
            });
            const [errors, setErrors] = useState({});
            const [loading, setLoading] = useState(false);
            const [showConfetti, setShowConfetti] = useState(false);

            const categories = ['Food', 'Travel', 'Rent', 'Shopping', 'Others'];

            useEffect(() => {
                if (editingExpense) {
                    setFormData({
                        amount: editingExpense.amount.toString(),
                        date: editingExpense.date.split('T')[0],
                        category: editingExpense.category,
                        note: editingExpense.note
                    });
                }
            }, [editingExpense]);

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));

                if (errors[name]) {
                    setErrors(prev => ({
                        ...prev,
                        [name]: ''
                    }));
                }
            };

            const validateForm = () => {
                const newErrors = {};

                if (!formData.amount) {
                    newErrors.amount = 'Amount is required';
                } else if (isNaN(formData.amount) || parseFloat(formData.amount) <= 0) {
                    newErrors.amount = 'Amount must be a positive number';
                }

                if (!formData.date) {
                    newErrors.date = 'Date is required';
                }

                if (!formData.category) {
                    newErrors.category = 'Category is required';
                }

                return newErrors;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                const newErrors = validateForm();

                if (Object.keys(newErrors).length > 0) {
                    setErrors(newErrors);
                    return;
                }

                setLoading(true);

                try {
                    if (editingExpense) {
                        // Update existing expense
                        await axios.put(`/expenses/${editingExpense._id}`, formData);
                    } else {
                        // Create new expense
                        await axios.post('/expenses', formData);
                        setShowConfetti(true);
                        setTimeout(() => setShowConfetti(false), 3000);
                    }

                    // Reset form if adding new expense
                    if (!editingExpense) {
                        setFormData({
                            amount: '',
                            date: new Date().toISOString().split('T')[0],
                            category: 'Food',
                            note: ''
                        });
                    }

                    setTimeout(() => {
                        onNavigate('expenses');
                    }, editingExpense ? 0 : 1500);

                } catch (error) {
                    console.error('Error saving expense:', error);
                    setErrors({ general: error.response?.data?.message || 'Failed to save expense. Please try again.' });
                } finally {
                    setLoading(false);
                }
            };

            const getCategoryIcon = (category) => {
                const icons = {
                    'Food': '',
                    'Travel': '',
                    'Rent': '',
                    'Shopping': '',
                    'Others': ''
                };
                return icons[category] || '';
            };

            return (
                <div className="add-expense">
                    {showConfetti && <div className="confetti"></div>}

                    <div className="add-expense-container">
                        <div className="add-expense-header">
                            <h1>{editingExpense ? 'Edit Expense' : 'Add New Expense'}</h1>
                            <p>{editingExpense ? 'Update your expense details' : 'Track your spending'}</p>
                        </div>

                        <form onSubmit={handleSubmit} className="expense-form">
                            {errors.general && (
                                <div className="error-message" style={{textAlign: 'center', marginBottom: '20px'}}>
                                    {errors.general}
                                </div>
                            )}

                            <div className="form-row">
                                <div className="form-group">
                                    <label className="form-label">Amount ()</label>
                                    <input
                                        type="number"
                                        name="amount"
                                        value={formData.amount}
                                        onChange={handleChange}
                                        className={`form-input ${errors.amount ? 'error' : ''}`}
                                        placeholder="0.00"
                                        step="0.01"
                                        min="0"
                                    />
                                    {errors.amount && <span className="error-message">{errors.amount}</span>}
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Date</label>
                                    <input
                                        type="date"
                                        name="date"
                                        value={formData.date}
                                        onChange={handleChange}
                                        className={`form-input ${errors.date ? 'error' : ''}`}
                                    />
                                    {errors.date && <span className="error-message">{errors.date}</span>}
                                </div>
                            </div>

                            <div className="form-group">
                                <label className="form-label">Category</label>
                                <select
                                    name="category"
                                    value={formData.category}
                                    onChange={handleChange}
                                    className={`form-input ${errors.category ? 'error' : ''}`}
                                >
                                    {categories.map(category => (
                                        <option key={category} value={category}>
                                            {getCategoryIcon(category)} {category}
                                        </option>
                                    ))}
                                </select>
                                {errors.category && <span className="error-message">{errors.category}</span>}
                            </div>

                            <div className="form-group">
                                <label className="form-label">Notes (Optional)</label>
                                <textarea
                                    name="note"
                                    value={formData.note}
                                    onChange={handleChange}
                                    className="form-textarea"
                                    placeholder="Add a note about this expense..."
                                    rows="4"
                                />
                            </div>

                            <div className="form-actions">
                                <button type="button" onClick={() => onNavigate('expenses')} className="btn-secondary">
                                    Cancel
                                </button>
                                <button type="submit" className="btn-primary" disabled={loading}>
                                    {loading ? (editingExpense ? 'Updating...' : 'Adding...') : (editingExpense ? 'Update Expense' : 'Add Expense')}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        // Expenses List Component
        const ExpensesList = ({ onNavigate }) => {
            const [expenses, setExpenses] = useState([]);
            const [filteredExpenses, setFilteredExpenses] = useState([]);
            const [loading, setLoading] = useState(true);
            const [filters, setFilters] = useState({
                category: '',
                month: '',
                year: new Date().getFullYear().toString(),
                startDate: '',
                endDate: ''
            });

            const categories = ['Food', 'Travel', 'Rent', 'Shopping', 'Others'];

            useEffect(() => {
                fetchExpenses();
            }, []);

            useEffect(() => {
                applyFilters();
            }, [expenses, filters]);

            const fetchExpenses = async () => {
                try {
                    const response = await axios.get('/expenses');
                    setExpenses(response.data);
                } catch (error) {
                    console.error('Error fetching expenses:', error);
                } finally {
                    setLoading(false);
                }
            };

            const applyFilters = () => {
                let filtered = [...expenses];

                if (filters.category) {
                    filtered = filtered.filter(expense => expense.category === filters.category);
                }

                if (filters.startDate && filters.endDate) {
                    filtered = filtered.filter(expense => {
                        const expenseDate = new Date(expense.date);
                        const startDate = new Date(filters.startDate);
                        const endDate = new Date(filters.endDate);
                        return expenseDate >= startDate && expenseDate <= endDate;
                    });
                }

                if (filters.month) {
                    filtered = filtered.filter(expense => {
                        const expenseDate = new Date(expense.date);
                        return expenseDate.getMonth() === parseInt(filters.month);
                    });
                }

                if (filters.year) {
                    filtered = filtered.filter(expense => {
                        const expenseDate = new Date(expense.date);
                        return expenseDate.getFullYear() === parseInt(filters.year);
                    });
                }

                filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
                setFilteredExpenses(filtered);
            };

            const handleFilterChange = (e) => {
                const { name, value } = e.target;
                setFilters(prev => ({
                    ...prev,
                    [name]: value
                }));
            };

            const clearFilters = () => {
                setFilters({
                    category: '',
                    month: '',
                    year: new Date().getFullYear().toString(),
                    startDate: '',
                    endDate: ''
                });
            };

            const handleEdit = (expense) => {
                // Navigate to edit mode
                onNavigate('add-expense', expense);
            };

            const handleDelete = async (id) => {
                if (window.confirm('Are you sure you want to delete this expense?')) {
                    try {
                        await axios.delete(`/expenses/${id}`);
                        setExpenses(prev => prev.filter(expense => expense._id !== id));
                    } catch (error) {
                        console.error('Error deleting expense:', error);
                        alert('Failed to delete expense. Please try again.');
                    }
                }
            };

            const getTotalAmount = () => {
                return filteredExpenses.reduce((total, expense) => total + parseFloat(expense.amount), 0);
            };

            const getCategoryIcon = (category) => {
                const icons = {
                    'Food': '',
                    'Travel': '',
                    'Rent': '',
                    'Shopping': '',
                    'Others': ''
                };
                return icons[category] || '';
            };

            return (
                <div className="expenses-page">
                    <div className="expenses-header">
                        <h1>Your Expenses</h1>
                        <button className="btn-primary" onClick={() => onNavigate('add-expense')}>
                            Add New Expense
                        </button>
                    </div>

                    <div className="filters-section">
                        <div className="filters-grid">
                            <div className="filter-group">
                                <label>Category</label>
                                <select name="category" value={filters.category} onChange={handleFilterChange} className="filter-input">
                                    <option value="">All Categories</option>
                                    {categories.map(category => (
                                        <option key={category} value={category}>
                                            {getCategoryIcon(category)} {category}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="filter-group">
                                <label>Month</label>
                                <select name="month" value={filters.month} onChange={handleFilterChange} className="filter-input">
                                    <option value="">All Months</option>
                                    {Array.from({ length: 12 }, (_, i) => (
                                        <option key={i} value={i}>
                                            {new Date(2024, i).toLocaleString('default', { month: 'long' })}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="filter-group">
                                <label>Year</label>
                                <select name="year" value={filters.year} onChange={handleFilterChange} className="filter-input">
                                    {Array.from({ length: 5 }, (_, i) => {
                                        const year = new Date().getFullYear() - i;
                                        return (
                                            <option key={year} value={year}>
                                                {year}
                                            </option>
                                        );
                                    })}
                                </select>
                            </div>

                            <div className="filter-group">
                                <label>Start Date</label>
                                <input
                                    type="date"
                                    name="startDate"
                                    value={filters.startDate}
                                    onChange={handleFilterChange}
                                    className="filter-input"
                                />
                            </div>

                            <div className="filter-group">
                                <label>End Date</label>
                                <input
                                    type="date"
                                    name="endDate"
                                    value={filters.endDate}
                                    onChange={handleFilterChange}
                                    className="filter-input"
                                />
                            </div>

                            <div className="filter-actions">
                                <button onClick={clearFilters} className="btn-secondary">
                                    Clear Filters
                                </button>
                            </div>
                        </div>
                    </div>

                    <div style={{maxWidth: '1200px', margin: '0 auto 30px auto'}}>
                        <div style={{background: 'linear-gradient(135deg, #3A0CA3, #F72585)', color: 'white', padding: '25px', borderRadius: '16px', textAlign: 'center', boxShadow: '0 10px 30px rgba(58, 12, 163, 0.3)'}}>
                            <h3 style={{fontSize: '28px', marginBottom: '5px'}}>Total: {getTotalAmount().toFixed(2)}</h3>
                            <p style={{opacity: '0.9', fontSize: '16px'}}>
                                {filteredExpenses.length} expense{filteredExpenses.length !== 1 ? 's' : ''}
                            </p>
                        </div>
                    </div>

                    {filteredExpenses.length > 0 ? (
                        <div className="expenses-grid">
                            {filteredExpenses.map(expense => (
                                <div key={expense._id} className="expense-card">
                                    <div className="expense-header">
                                        <div className="expense-category">
                                            <span className="category-icon">
                                                {getCategoryIcon(expense.category)}
                                            </span>
                                            <div>
                                                <h3>{expense.category}</h3>
                                                <p className="expense-date">
                                                    {new Date(expense.date).toLocaleDateString('en-IN', {
                                                        day: 'numeric',
                                                        month: 'short',
                                                        year: 'numeric'
                                                    })}
                                                </p>
                                            </div>
                                        </div>
                                        <div className="expense-amount">{parseFloat(expense.amount).toFixed(2)}</div>
                                    </div>

                                    {expense.note && (
                                        <div className="expense-note">
                                            <p>{expense.note}</p>
                                        </div>
                                    )}

                                    <div className="expense-actions">
                                        <button onClick={() => handleEdit(expense)} className="btn-edit">
                                            Edit
                                        </button>
                                        <button onClick={() => handleDelete(expense._id)} className="btn-delete">
                                            Delete
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="no-expenses">
                            <h3>No expenses found</h3>
                            <p>Try adjusting your filters or add a new expense.</p>
                            <button className="btn-primary" onClick={() => onNavigate('add-expense')}>
                                Add Your First Expense
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        // Profile Component
        const Profile = () => {
            const { user, logout } = useAuth();
            const [expenses, setExpenses] = useState([]);
            const [stats, setStats] = useState({
                totalExpenses: 0,
                totalAmount: 0,
                mostFrequentCategory: '',
                longestStreak: 0,
                averageDaily: 0
            });
            const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);

            useEffect(() => {
                fetchExpenses();
            }, []);

            useEffect(() => {
                calculateStats(expenses);
            }, [expenses]);

            const fetchExpenses = async () => {
                try {
                    const response = await axios.get('/expenses');
                    setExpenses(response.data);
                } catch (error) {
                    console.error('Error fetching expenses:', error);
                }
            };

            const calculateStats = (expensesData) => {
                if (expensesData.length === 0) {
                    setStats({
                        totalExpenses: 0,
                        totalAmount: 0,
                        mostFrequentCategory: 'None',
                        longestStreak: 0,
                        averageDaily: 0
                    });
                    return;
                }

                const totalExpenses = expensesData.length;
                const totalAmount = expensesData.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);

                const categoryCount = expensesData.reduce((acc, expense) => {
                    acc[expense.category] = (acc[expense.category] || 0) + 1;
                    return acc;
                }, {});
                const mostFrequentCategory = Object.keys(categoryCount).reduce((a, b) => 
                    categoryCount[a] > categoryCount[b] ? a : b
                );

                const sortedExpenses = expensesData.map(expense => new Date(expense.date)).sort((a, b) => a - b);
                let longestStreak = 1;
                let currentStreak = 1;

                for (let i = 1; i < sortedExpenses.length; i++) {
                    const diffTime = Math.abs(sortedExpenses[i] - sortedExpenses[i - 1]);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                    if (diffDays <= 1) {
                        currentStreak++;
                    } else {
                        longestStreak = Math.max(longestStreak, currentStreak);
                        currentStreak = 1;
                    }
                }
                longestStreak = Math.max(longestStreak, currentStreak);

                const uniqueDays = new Set(expensesData.map(expense => new Date(expense.date).toDateString())).size;
                const averageDaily = totalAmount / uniqueDays;

                setStats({
                    totalExpenses,
                    totalAmount,
                    mostFrequentCategory,
                    longestStreak: sortedExpenses.length > 0 ? longestStreak : 0,
                    averageDaily: isNaN(averageDaily) ? 0 : averageDaily
                });
            };

            const handleDeleteAccount = () => {
                logout();
            };

            const getCategoryIcon = (category) => {
                const icons = {
                    'Food': '',
                    'Travel': '',
                    'Rent': '',
                    'Shopping': '',
                    'Others': ''
                };
                return icons[category] || '';
            };

            return (
                <div className="profile">
                    <div className="profile-container">
                        <div className="profile-header">
                            <div className="profile-avatar">
                                {user?.username?.charAt(0).toUpperCase()}
                            </div>
                            <div className="profile-info">
                                <h1>{user?.username}</h1>
                                <p>{user?.email}</p>
                                <small>Member since {new Date(user?.createdAt || Date.now()).toLocaleDateString()}</small>
                            </div>
                        </div>

                        <div className="profile-stats">
                            <h2>Your Expense Statistics</h2>
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-icon"></div>
                                    <div className="stat-content">
                                        <h3>Total Amount</h3>
                                        <p className="stat-value">{stats.totalAmount.toFixed(2)}</p>
                                    </div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-icon"></div>
                                    <div className="stat-content">
                                        <h3>Total Expenses</h3>
                                        <p className="stat-value">{stats.totalExpenses}</p>
                                    </div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-icon">{getCategoryIcon(stats.mostFrequentCategory)}</div>
                                    <div className="stat-content">
                                        <h3>Top Category</h3>
                                        <p className="stat-value">{stats.mostFrequentCategory}</p>
                                    </div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-icon"></div>
                                    <div className="stat-content">
                                        <h3>Longest Streak</h3>
                                        <p className="stat-value">{stats.longestStreak} days</p>
                                    </div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-icon"></div>
                                    <div className="stat-content">
                                        <h3>Daily Average</h3>
                                        <p className="stat-value">{stats.averageDaily.toFixed(2)}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style={{background: 'rgba(255, 255, 255, 0.95)', backdropFilter: 'blur(20px)', borderRadius: '20px', padding: '40px', boxShadow: '0 15px 50px rgba(0, 0, 0, 0.1)', border: '1px solid rgba(255, 255, 255, 0.2)'}}>
                            <h2 style={{fontSize: '24px', color: '#333', marginBottom: '25px', textAlign: 'center'}}>Account Actions</h2>
                            <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '20px'}}>
                                <button onClick={logout} className="btn-secondary" style={{width: '100%', padding: '15px 30px'}}>
                                    Logout
                                </button>
                                <button onClick={() => setShowDeleteConfirm(true)} style={{background: 'linear-gradient(135deg, #dc3545, #c82333)', color: 'white', border: 'none', padding: '15px 30px', borderRadius: '12px', fontWeight: '600', cursor: 'pointer', transition: 'all 0.3s ease', width: '100%'}}>
                                    Delete Account
                                </button>
                            </div>
                        </div>

                        {showDeleteConfirm && (
                            <div className="modal-overlay">
                                <div className="modal">
                                    <h3>Delete Account</h3>
                                    <p>Are you sure you want to delete your account? This action cannot be undone and will permanently delete all your expenses.</p>
                                    <div className="modal-actions">
                                        <button onClick={() => setShowDeleteConfirm(false)} className="btn-secondary">
                                            Cancel
                                        </button>
                                        <button onClick={handleDeleteAccount} style={{background: 'linear-gradient(135deg, #dc3545, #c82333)', color: 'white', border: 'none', padding: '12px 24px', borderRadius: '8px', fontWeight: '600', cursor: 'pointer', minWidth: '120px'}}>
                                            Delete Account
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const { user, loading } = useAuth();
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [isLogin, setIsLogin] = useState(true);
            const [editingExpense, setEditingExpense] = useState(null);

            const handleNavigate = (page, data = null) => {
                setCurrentPage(page);
                if (page === 'add-expense' && data) {
                    setEditingExpense(data);
                } else {
                    setEditingExpense(null);
                }
            };

            if (loading) {
                return (
                    <div className="loading-container">
                        <div className="loading-spinner"></div>
                        <p>Loading TrackWise...</p>
                    </div>
                );
            }

            if (!user) {
                return isLogin ? (
                    <Login onSwitchToSignup={() => setIsLogin(false)} />
                ) : (
                    <Signup onSwitchToLogin={() => setIsLogin(true)} />
                );
            }

            const renderPage = () => {
                switch (currentPage) {
                    case 'dashboard':
                        return <Dashboard onNavigate={handleNavigate} />;
                    case 'add-expense':
                        return <AddExpense onNavigate={handleNavigate} editingExpense={editingExpense} />;
                    case 'expenses':
                        return <ExpensesList onNavigate={handleNavigate} />;
                    case 'profile':
                        return <Profile />;
                    default:
                        return <Dashboard onNavigate={handleNavigate} />;
                }
            };

            return (
                <div>
                    <Navbar currentPage={currentPage} onNavigate={handleNavigate} />
                    {renderPage()}
                </div>
            );
        };

        // Render the App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <AuthProvider>
                <App />
            </AuthProvider>
        );
    </script>
</body>
</html>
